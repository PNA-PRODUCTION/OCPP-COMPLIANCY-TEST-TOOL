<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OCPP Compliancy Test Runner - v<%= appVersion %></title>
  <link rel="stylesheet" href="./user_index.css">
  <script type="module" src="./user_index.js"></script>
  <script>
    // License mode from server
    window.LICENSE_MODE = '<%= typeof licenseMode !== "undefined" ? licenseMode : "FULL" %>';
    <% if (typeof licenseMode !== "undefined" && licenseMode === "DEMO") { %>
    window.AVAILABLE_TEST_CASES = ['TC_000_CS', 'TC_001_CS', 'TC_002_CS', 'TC_003_CS'];
    <% } else { %>
    window.AVAILABLE_TEST_CASES = null;
    <% } %>
    
    // ìš°í´ë¦­ ë°©ì§€
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
      return false;
    });

    // ì„ íƒ ë°©ì§€ (ì„ íƒì )
    document.addEventListener('selectstart', function(e) {
      e.preventDefault();
      return false;
    });

    // ë“œë˜ê·¸ ë°©ì§€ (ì„ íƒì )
    document.addEventListener('dragstart', function(e) {
      e.preventDefault();
      return false;
    });
  </script>
</head>
<body>
  <div id="mainContent">
    <!-- Header Section -->
    <header class="header-section">
      <div class="header-content">
        <div class="header-top">
          <h1 class="main-title">
            <span class="icon">âš¡</span>
            OCPP Compliancy Test Runner
          </h1>
          <span class="version-badge">v<%= appVersion %></span>
        </div>
        <p class="subtitle">Charge Point Testing & Validation Platform</p>
      </div>
    </header>

    <!-- Control Panel Card -->
    <div class="card control-card">
      <div class="card-header">
        <h2>Test Control Panel</h2>
      </div>
      <div class="card-body">
        <div class="form-group">
          <label for="tcSelect" class="label">
            <span class="label-icon">ğŸ“‹</span>
            Select Test Case
          </label>
          <select id="tcSelect" class="select">
            <option value="TC_000_CS">TC_000_CS â€” Normal Test (OCPP behavior monitoring - all requests accepted)</option>
            <option value="TC_001_CS">TC_001_CS â€” Cold Boot Charge Point (To test if the Charge Point sends the correct messages during the boot process.)</option>
            <option value="TC_002_CS">TC_002_CS â€” Cold Boot Charge Point-Pending (This scenario is used to delay the startup for a Charge Point. For example to set the correct configurations.)</option>
            <option value="TC_003_CS">TC_003_CS â€” Regular Charging Session - Plugin First</option>
            <option value="TC_004_1_CS">TC_004_1_CS â€” Regular Charging Session â€“ Identification First</option>
            <option value="TC_004_2_CS">TC_004_2_CS â€” Regular Charging Session â€“ Identification First - ConnectionTimeOut</option>
            <option value="TC_005_1_CS">TC_005_1_CS â€” EV Side Disconnected - StopTransactionOnEVSideDisconnect = true - UnlockConnectorOnEVSideDisconnect = true</option>
            <option value="TC_005_2_CS">TC_005_2_CS â€” EV Side Disconnected - StopTransactionOnEVSideDisconnect = true - UnlockConnectorOnEVSideDisconnect = false</option>
            <option value="TC_005_3_CS">TC_005_3_CS â€” EV Side Disconnected - StopTransactionOnEVSideDisconnect = false - UnlockConnectorOnEVSideDisconnect = false</option>
            <option value="TC_010_CS">TC_010_CS â€” Remote Start Charging Session - Cable Plugged in First</option>
            <option value="TC_011_1_CS">TC_011_1_CS â€” Remote Start Charging Session - Remote Start First</option>
            <option value="TC_011_2_CS">TC_011_2_CS â€” Remote Start Charging Session - Time Out</option>
            <option value="TC_012_CS">TC_012_CS â€” Remote Stop Charging Session</option>
            <option value="TC_013_CS">TC_013_CS â€” Hard Reset Without transaction</option>
            <option value="TC_014_CS">TC_014_CS â€” Soft Reset Without Transaction</option>
            <option value="TC_015_CS">TC_015_CS â€” Hard Reset With Transaction</option>
            <option value="TC_016_CS">TC_016_CS â€” Soft Reset With Transaction</option>
            <option value="TC_017_1_CS">TC_017_1_CS â€” Unlock connector - no charging session running (Not fixed cable)</option>
            <option value="TC_017_2_CS">TC_017_2_CS â€” Unlock connector - no charging session running (Fixed cable)</option>
            <option value="TC_018_1_CS">TC_018_1_CS â€” Unlock Connector - With Charging Session (Not fixed cable)</option>
            <option value="TC_018_2_CS">TC_018_2_CS â€” Unlock Connector - With Charging Session (Fixed cable)</option>
            <option value="TC_019_CS">TC_019_CS â€” Retrieve configuration</option>
            <option value="TC_021_CS">TC_021_CS â€” Change/set Configuration</option>
            <option value="TC_023_CS">TC_023_CS â€” Start Charging Session - Authorize invalid</option>
            <option value="TC_024_CS">TC_024_CS â€” Connector Lock Failure</option>
            <option value="TC_026_CS">TC_026_CS â€” Remote Start Charging Session - Rejected</option>
            <option value="TC_027_CS">TC_027_CS â€” Remote start transaction - connector id shall not be 0</option>
            <option value="TC_028_CS">TC_028_CS â€” Remote Stop Transaction - Rejected</option>
            <option value="TC_030_CS">TC_030_CS â€” Unlock Connector - Unlock Failure</option>
            <option value="TC_031_CS">TC_031_CS â€” Unlock Connector - Unknown Connector</option>
            <option value="TC_032_1_CS">TC_032_1_CS â€” Power failure boot charging point - configured to stop transaction(s) before going down</option>
            <option value="TC_032_2_CS">TC_032_2_CS â€” Power failure boot charging point-configured to stop transaction(s)</option>
            <option value="TC_034_CS">TC_034_CS â€” Power Failure with Unavailable Status</option>
            <option value="TC_036_CS">TC_036_CS â€” Connection Loss During Transaction</option>
            <option value="TC_038_CS">TC_038_CS â€” Offline Stop Transaction</option>
            <option value="TC_040_1_CS">TC_040_1_CS â€” Configuration key - NotSupported</option>
            <option value="TC_040_2_CS">TC_040_2_CS â€” Configuration key - Invalid value</option>
            <option value="TC_042_1_CS">TC_042_1_CS â€” Get Local List Version (not supported)</option>
            <option value="TC_042_2_CS">TC_042_2_CS â€” Get Local List Version (empty)</option>
            <option value="TC_054_CS">TC_054_CS â€” Trigger Message</option>
            <option value="TC_055_CS">TC_055_CS â€” Trigger Message - Rejected</option>
            <option value="TC_062_CS">TC_062_CS â€” Data Transfer to a Charge Point</option>
            <option value="TC_068_CS">TC_068_CS â€” Stop transaction - IdTag in StopTransaction matches IdTag in StartTransaction</option>
            <option value="TC_069_CS">TC_069_CS â€” Stop transaction - ParentIdTag in StopTransaction matches ParentIdTag in StartTransaction</option>
            <option value="TC_070_CS">TC_070_CS â€” Sampled Meter Values</option>
            <option value="TC_071_CS">TC_071_CS â€” Clock-aligned Meter Values</option>
          </select>
        </div>

        <div class="buttons">
          <button class="btn btn-primary" id="Btn_Start">
            <span class="btn-icon">â–¶</span>
            <span>TEST START</span>
          </button>
          <button class="btn btn-danger" id="Btn_Stop">
            <span class="btn-icon">â¹</span>
            <span>TEST STOP</span>
          </button>
          <button class="btn btn-secondary" id="Btn_Clear">
            <span class="btn-icon">ğŸ—‘ï¸</span>
            <span>CLEAR LOG</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Messages Log Card -->
    <div class="card log-card">
      <div class="log-header">
        <div class="log-header-left">
          <span class="log-icon">ğŸ’¬</span>
          <span>Messages</span>
          <span class="log-count" id="logCount">0</span>
        </div>
        <div class="log-header-right">
          <button class="btn-icon-small" id="Btn_SaveLog" title="Save Messages to File">
            <span>ğŸ’¾</span>
            <span>Save</span>
          </button>
        </div>
      </div>
      <pre id="msgArea" class="log-body"></pre>
    </div>

    <!-- Test Description Card -->
    <div class="card description">
      <div class="description-header">
        <span class="desc-icon">ğŸ“–</span>
        <span>Test Description</span>
      </div>
      <div class="description-body" id="msgDescription">
        <img id="descImage" src="" alt="Test Description" style="max-width:100%; max-height:100%; object-fit:contain;">
      </div>
    </div>

    <!-- Message Layer (Modal) -->
    <div id="messageLayer" class="message-layer">
      <div class="message-box">
        <div class="message-icon" id="messageIcon"></div>
        <p id="messageText"></p>
        <button id="messageOkBtn" class="btn btn-primary">OK</button>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer-section">
      <img src="./demo_images/pna_logo.png" id="pna_logo" alt="PNA Logo">
      <p class="footer-text">OCPP Test Server v<%= appVersion %></p>
    </footer>
  </div>
</body>
</html>
